var hashLoc,hashSet=function(a){if(a||a.p){hashLoc=a.p;switch(a.p){default:a.d&&(hashLoc+="_"+a.d,a.d1&&(hashLoc+="_"+a.d1))}VK.callMethod("setLocation",hashLoc)}};
$(document).on("click","#project .unit",function(){location.href=URL+"&p=main&d=project&d1=info&id="+$(this).attr("val")}).ready(function(){$("#project").length&&$(".add").click(function(){function a(){var a={op:"project_add",name:$("#name").val(),about:$("#about").val()};a.name?(b.process(),$.post(AJAX_MAIN,a,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Новый проект добавлен")):b.abort()},"json")):(b.err("Не указано название"),$("#name").focus())}$(this);var b=_dialog({head:"Добавление нового проекта",
content:'<table id="project-tab-add"><tr><td class="label r">Название:<td><input id="name" type="text" /><tr><td class="label r top">Описание:<td><textarea id="about"></textarea></table>',submit:a});$("#name").focus().keyEnter(a);$("#about").autosize()});$("#project-info").length&&$(".add").click(function(){function a(){var a={op:"task_add",project_id:PROJECT.id,name:$("#name").val()};a.name?(b.process(),$.post(AJAX_MAIN,a,function(a){a.success?($("#spisok").html(a.html),b.close(),_msg("Новая задача добавлена")):
b.abort()},"json")):(b.err("Не указано название задачи"),$("#name").focus())}$(this);var b=_dialog({top:30,width:420,head:"Добавление новой задачи",butSubmit:"Добавить",content:'<table id="task-tab-add"><tr><td class="label r">Задача:<td><input id="name" type="text" /></table>',submit:a});$("#name").focus().keyEnter(a)})});
